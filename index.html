<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>BulkGet — Home</title>
  <style>
    body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial}
    header{position:sticky;top:0;background:#111;color:#fff;padding:12px 16px}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;padding:12px}
    .card{background:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px rgba(0,0,0,.08);cursor:pointer}
    .thumb{aspect-ratio:16/9;width:100%;object-fit:cover;background:#000}
    .meta{padding:8px 10px}
    .title{font-size:14px;line-height:1.3;height:2.6em;overflow:hidden}
    .bar{display:flex;gap:8px;padding:8px 12px;background:#f5f5f7}
    .bar button{padding:8px 12px;border:0;border-radius:999px;background:#e8e8ef}
    .bar input{flex:1;padding:8px 12px;border-radius:999px;border:1px solid #ddd}
  </style>
</head>
<body>
  <header><b>BulkGet Viewer</b> — Home</header>
  <div class="bar">
    <button data-tab="popular">มาแรง</button>
    <button data-tab="music">เพลง</button>
    <button data-tab="gaming">เกม</button>
    <button data-tab="news">ข่าว</button>
    <input id="q" placeholder="ค้นหา YouTube..." />
  </div>
  <div id="list" class="grid"></div>

  <script>
    const API_KEY = "YOUR_API_KEY";                 // ใส่คีย์ของคุณ
    const REGION  = "TH";
    const PLAYER  = "https://bulkget.github.io/player.html?v="; // เปลี่ยนเป็นโดเมนคุณ

    const list = document.getElementById('list');
    const q = document.getElementById('q');

    // โหลดแท็บเริ่มต้น
    loadMostPopular();

    // แท็บ
    document.querySelectorAll('.bar button').forEach(b=>{
      b.onclick=()=>{
        const t=b.dataset.tab;
        if(t==='popular') loadMostPopular();
        if(t==='music')   search('topic music');
        if(t==='gaming')  search('topic gaming');
        if(t==='news')    search('news');
      };
    });

    // ค้นหา
    q.addEventListener('keydown',e=>{
      if(e.key==='Enter' && q.value.trim()) search(q.value.trim());
    });

    async function loadMostPopular(){
      const url = `https://www.googleapis.com/youtube/v3/videos?part=snippet,contentDetails,statistics&chart=mostPopular&maxResults=24&regionCode=${REGION}&key=${API_KEY}`;
      const data = await fetchJson(url);
      render(data.items.map(x=>({
        id: x.id,
        title: x.snippet.title,
        thumb: x.snippet.thumbnails.medium.url
      })));
    }

    async function search(query){
      const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=24&q=${encodeURIComponent(query)}&regionCode=${REGION}&key=${API_KEY}`;
      const data = await fetchJson(url);
      render(data.items.map(x=>({
        id: x.id.videoId,
        title: x.snippet.title,
        thumb: x.snippet.thumbnails.medium.url
      })));
    }

    async function fetchJson(u){
      const r = await fetch(u);
      if(!r.ok) throw new Error('API error');
      return r.json();
    }

    function render(items){
      list.innerHTML = items.map(it=>`
        <a class="card" href="${PLAYER}${it.id}">
          <img class="thumb" loading="lazy" src="${it.thumb}" alt="">
          <div class="meta"><div class="title">${it.title}</div></div>
        </a>
      `).join('');
    }
  </script>
</body>
</html>
